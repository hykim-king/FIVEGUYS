<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fiveguys.pilldex.user">
  <!-- 아이디 체크 -->
	<select id="idCheck" parameterType="UserVO" resultType="int">
	  SELECT COUNT(*) cnt
	  FROM member
	  WHERE id = #{id}
	</select>
	<!-- 아이디 + 패스워드 체크 -->
	<select id="passCheck" parameterType="UserVO" resultType="int">
	  SELECT COUNT(*) cnt
	  FROM member
	  WHERE id = #{id}
	  AND pw = #{pw}
	</select>

	<resultMap id="UserMap" type="UserVO">
		<result column="no"         property="no"       />
		<result column="grade"      property="grade"    />
		<result column="name"       property="name"     />
		<result column="id"         property="id"       />
		<result column="pw"         property="pw"       />
		<result column="tel"        property="tel"      />
		<result column="birth"      property="birth"    />
		<result column="sex"        property="sex"      />
		<result column="post_num"   property="postNum"  />
		<result column="n_addr"     property="nAddr"    />
		<result column="o_addr"     property="oAddr"    />
		<result column="rest_addr"  property="restAddr" />
		<result column="email"      property="email"    /> 
		<result column="reg_dt"     property="regDt"    />
		<result column="del"        property="del"      />
	</resultMap>	
  <!-- 아이디 + 패스워드로 회원정보 반환 -->
	<select id="doSelectOne" parameterType="UserVO"  resultMap="UserMap" >
		SELECT *
		FROM member
		WHERE id = #{id} 
		AND pw = #{pw}
	</select>
	
	<!-- 회원가입  -->
	<insert id="insertOne" parameterType="UserVO" >
    INSERT INTO member (
        no,       
        grade,    
				name,     
				id,       
				pw,       
				tel,      
				birth,    
				sex,      
				post_num, 
				n_addr,   
				o_addr,   
				rest_addr,
				email,    
				reg_dt,   
				del 
     ) VALUES (
        MEMBER_NO.NEXTVAL,
        #{grade},    
        #{name},     
        #{id},       
        #{pw},       
        #{tel},    
        TO_DATE(#{birth},'YY/MM/DD'),
        #{sex},      
        #{postNum}, 
        #{nAddr},   
        #{oAddr},   
        #{restAddr},
        #{email},
        SYSDATE,  
        #{del}
     )      
  </insert>
  
  <delete id="deleteOne" parameterType="UserVO">
    DELETE FROM member
    WHERE id = #{id}
  </delete>
</mapper>

